<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard - Shop Clothes</title>
    <link rel="stylesheet" href="admin.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style="background-color: #FF4B2B;">
      <nav class="navbar navbar-expand-md bg-light navbar-light">
        <div class="container pt-2 pb-2">
            <a class="navbar-brand" href="#">
                <img src="https://cdn-icons-png.flaticon.com/128/6024/6024190.png" width="40" alt="">
                Admin!
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="collapsibleNavbar">
                <ul class="navbar-nav text-uppercase">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Collection</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Special</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Blogs</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">About us</a>
                    </li>
                    <li>
                        <button " onclick="logout()">Logout</button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
 

    <div style="display: flex; justify-content: center; gap: 5%;">
        <div><div style="justify-items: center;">
    <div class="admin-container">
    <form class="admin-form"> 
        
   <div>
    <hr>
    <h2>Products Management</h2>
   
        <input type="text" id="productName" placeholder="Product Name">
        <input type="number" id="productPrice" placeholder="Price" step="0.01">
        <button style=" width: 100%; padding: 12px; border-radius: 20px; border: none; background-color: #FF4B2B; color: white; font-weight: bold; cursor: pointer; transition: transform 0.2s;"
        onclick="addProduct()">Add Product</button>
        <hr>
        <br>
        <div id="products">Loading products...</div>
    </div>
    <br>

</div> 
</div></div>
        <div><div style="justify-items: center;">
    <div class="admin-container">
    <form class="admin-form"> 
        <h2>Orders</h2>
        <hr>
        <div id="orders">Loading orders...</div>
</div> 
</div></div>
    </div>
    
<!-- <div style="justify-items: center;">
    <div class="admin-container">
    <form class="admin-form"> 
        
   <div>
    <hr>
    <h2>Products Management</h2>
   
        <input type="text" id="productName" placeholder="Product Name">
        <input type="number" id="productPrice" placeholder="Price" step="0.01">
        <button style=" width: 100%; padding: 12px; border-radius: 20px; border: none; background-color: #FF4B2B; color: white; font-weight: bold; cursor: pointer; transition: transform 0.2s;"
        onclick="addProduct()">Add Product</button>
        <hr>
        <br>
        <div id="products">Loading products...</div>
    </div>
    <br>

</div> 
</div>

 <div style="justify-items: center;">
    <div class="admin-container">
    <form class="admin-form"> 
        <h2>Orders</h2>
        <hr>
        <div id="orders">Loading orders...</div>
</div> 
</div> -->



 

<script>
// ======= Load Products =======
async function loadProducts() {
    const res = await fetch('/user/products');
    const data = await res.json();

    let html = '';
    data.forEach(p => {
        html += `<div class="product">
                    <table style="width:100%">
                        <thead>
                            <tr  style="text-align:left" >
                                <th>Product</th>
                                <th>Price</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tr>
                            <td width="100" style="text-align:left">${p.name}</b></td>
                            <td style="text-align:left">$${Number(p.price).toFixed(2)}</td>
                            <td width="100">
                                <button onclick="editProduct(${p.id})"><img width="15px" src="https://cdn-icons-png.flaticon.com/128/1828/1828911.png" alt=""></button>
                                <button onclick="deleteProduct(${p.id})"><img width="15px" src="https://cdn-icons-png.flaticon.com/128/484/484611.png" alt=""></button>
                            </td>
                        </tr>
                    </table>
                 </div>
                 
                 `;
    });
    document.getElementById('products').innerHTML = html;
}

// ======= Add Product =======
async function addProduct() {
    const name = document.getElementById('productName').value;
    const price = parseFloat(document.getElementById('productPrice').value);

    const res = await fetch('/admin/add-product', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({name, price})
    });
    alert(await res.text());
    loadProducts();
    document.getElementById('productName').value = '';
    document.getElementById('productPrice').value = '';
}

// ======= Edit Product =======
function editProduct(id) {
    const newName = prompt('Enter new product name:');
    const newPrice = parseFloat(prompt('Enter new price:'));

    fetch('/admin/update-product', {
        method: 'PUT',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({id, name: newName, price: newPrice})
    }).then(res => res.text())
      .then(msg => { alert(msg); loadProducts(); });
}

// ======= Delete Product =======
function deleteProduct(id) {
    if (!confirm('Are you sure?')) return;

    fetch('/admin/delete-product', {
        method: 'DELETE',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({id})
    }).then(res => res.text())
      .then(msg => { alert(msg); loadProducts(); });
}

// ======= Load Orders =======
async function loadOrders() {
    const res = await fetch('/admin/orders');
    const data = await res.json();

    let html = '';
    data.forEach(o => {
        html += `<div class="order">
                    <table style="width:100%">
                        <thead>
                            <tr  style="text-align:left" >
                                <th>Product</th>
                                <th> Quantity</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tr>
                            <td width="100" style="text-align:left">${o.product_name}</b></td>
                            <td style="text-align:left">${o.quantity}</td>
                            <td width="100">
                            </td>
                        </tr>
                    </table>
                 </div>
                 
                 `;
    });
    document.getElementById('orders').innerHTML = html;
}

// ======= Logout =======
function logout() {
    window.location.href = 'adminLogin.html';
}

// ======= Initialize =======
window.onload = () => {
    loadProducts();
    loadOrders();
};
</script>
</body>
</html>
